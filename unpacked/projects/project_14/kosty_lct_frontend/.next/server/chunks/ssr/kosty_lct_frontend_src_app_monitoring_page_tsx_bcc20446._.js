module.exports=[44530,a=>{"use strict";a.s(["default",()=>aJ],44530);var b=a.i(85631),c=a.i(6365),d=a.i(47592),e=a.i(20834),f=a.i(18472);let g=()=>(0,f.useWebSocketStore)(a=>a.lastAIMessage),h=()=>(0,f.useWebSocketStore)(a=>a.aiStatus);(0,d.create)()((0,e.devtools)(a=>({loading:!1,error:null,setLoading:b=>a({loading:b}),setError:b=>a({error:b}),clearError:()=>a({error:null})}),{name:"main-store"}));var i=a.i(42226),j=a.i(14456),k=a.i(94260);a.i(42129),a.i(45934),a.i(38319),a.i(7701),a.i(78323);var l=a.i(79301);function m({title:a,data:c,series:d,yLabel:e,height:f=300,scrollable:g,pixelsPerSecond:h}){return(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-muted-foreground",children:a}),(0,b.jsx)(l.RealtimeUPlot,{data:c,series:d,yLabel:e,height:f,scrollable:g,pixelsPerSecond:h})]})}var n=a.i(19699);function o(a){if(!a.length)return[[],[]];let b=a[0]?.time_sec??0;return[a.map(a=>a.time_sec-b),a.map(a=>a.value)]}function p(){let[a,d]=(0,c.useState)("window");(0,j.useBPMWebSocket)(),(0,j.useUCWebSocket)();let e=(0,f.useWebSocketStore)(a=>a.bpmData),g=(0,f.useWebSocketStore)(a=>a.ucData),h=(0,k.useSlidingWindow)(e,{windowSize:100,maxPoints:250}),i=(0,k.useSlidingWindow)(g,{windowSize:100,maxPoints:250}),{chartData:l,dataCount:p,updateTime:q}=h,{chartData:r,dataCount:s,updateTime:t}=i,u=(0,c.useMemo)(()=>o(e),[e]),v=(0,c.useMemo)(()=>o(g),[g]);"window"===a||e.length,"window"===a||g.length;let w="scroll"===a;return(0,c.useEffect)(()=>{if("window"!==a)return;let b=setInterval(()=>{q(),t()},1e3);return()=>clearInterval(b)},[a,q,t]),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Режим отображения"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(n.Button,{size:"sm",variant:"window"===a?"default":"outline",onClick:()=>d("window"),children:"Скользящее окно"}),(0,b.jsx)(n.Button,{size:"sm",variant:"scroll"===a?"default":"outline",onClick:()=>d("scroll"),children:"Горизонтальный скролл"})]})]}),(0,b.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,b.jsx)(m,{title:"Heart Rate (BPM)",data:"window"===a?l:u,series:[{label:"BPM",color:"rgb(59, 130, 246)"}],yLabel:"сек / BPM",scrollable:w,pixelsPerSecond:w?6:void 0}),(0,b.jsx)(m,{title:"Uterine Contractions (UC)",data:"window"===a?r:v,series:[{label:"UC",color:"rgb(16, 185, 129)"}],yLabel:"сек / UC",scrollable:w,pixelsPerSecond:w?6:void 0})]})]})}var q=a.i(45386),r=a.i(34012),s=a.i(77982),t="Progress",[u,v]=(0,r.createContextScope)(t),[w,x]=u(t),y=c.forwardRef((a,c)=>{var d,e;let{__scopeProgress:f,value:g=null,max:h,getValueLabel:i=B,...j}=a;(h||0===h)&&!E(h)&&console.error((d=`${h}`,`Invalid prop \`max\` of value \`${d}\` supplied to \`Progress\`. Only numbers greater than 0 are valid max values. Defaulting to \`100\`.`));let k=E(h)?h:100;null===g||F(g,k)||console.error((e=`${g}`,`Invalid prop \`value\` of value \`${e}\` supplied to \`Progress\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or 100 if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`));let l=F(g,k)?g:null,m=D(l)?i(l,k):void 0;return(0,b.jsx)(w,{scope:f,value:l,max:k,children:(0,b.jsx)(s.Primitive.div,{"aria-valuemax":k,"aria-valuemin":0,"aria-valuenow":D(l)?l:void 0,"aria-valuetext":m,role:"progressbar","data-state":C(l,k),"data-value":l??void 0,"data-max":k,...j,ref:c})})});y.displayName=t;var z="ProgressIndicator",A=c.forwardRef((a,c)=>{let{__scopeProgress:d,...e}=a,f=x(z,d);return(0,b.jsx)(s.Primitive.div,{"data-state":C(f.value,f.max),"data-value":f.value??void 0,"data-max":f.max,...e,ref:c})});function B(a,b){return`${Math.round(a/b*100)}%`}function C(a,b){return null==a?"indeterminate":a===b?"complete":"loading"}function D(a){return"number"==typeof a}function E(a){return D(a)&&!isNaN(a)&&a>0}function F(a,b){return D(a)&&!isNaN(a)&&a<=b&&a>=0}function G({className:a,indicatorClassName:c,value:d,...e}){return(0,b.jsx)(y,{"data-slot":"progress",className:(0,i.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",a),...e,children:(0,b.jsx)(A,{"data-slot":"progress-indicator",className:(0,i.cn)("bg-primary h-full w-full flex-1 transition-all",c),style:{transform:`translateX(-${100-(d||0)}%)`}})})}A.displayName=z;var H=a.i(62208),I=a.i(16639),J=a.i(61411),K=c.createContext(void 0),L=a.i(68288),M=a.i(41066),N="ScrollArea",[O,P]=(0,r.createContextScope)(N),[Q,R]=O(N),S=c.forwardRef((a,d)=>{let{__scopeScrollArea:e,type:f="hover",dir:g,scrollHideDelay:h=600,...i}=a,[j,k]=c.useState(null),[l,m]=c.useState(null),[n,o]=c.useState(null),[p,q]=c.useState(null),[r,t]=c.useState(null),[u,v]=c.useState(0),[w,x]=c.useState(0),[y,z]=c.useState(!1),[A,B]=c.useState(!1),C=(0,I.useComposedRefs)(d,a=>k(a)),D=function(a){let b=c.useContext(K);return a||b||"ltr"}(g);return(0,b.jsx)(Q,{scope:e,type:f,dir:D,scrollHideDelay:h,scrollArea:j,viewport:l,onViewportChange:m,content:n,onContentChange:o,scrollbarX:p,onScrollbarXChange:q,scrollbarXEnabled:y,onScrollbarXEnabledChange:z,scrollbarY:r,onScrollbarYChange:t,scrollbarYEnabled:A,onScrollbarYEnabledChange:B,onCornerWidthChange:v,onCornerHeightChange:x,children:(0,b.jsx)(s.Primitive.div,{dir:D,...i,ref:C,style:{position:"relative","--radix-scroll-area-corner-width":u+"px","--radix-scroll-area-corner-height":w+"px",...a.style}})})});S.displayName=N;var T="ScrollAreaViewport",U=c.forwardRef((a,d)=>{let{__scopeScrollArea:e,children:f,nonce:g,...h}=a,i=R(T,e),j=c.useRef(null),k=(0,I.useComposedRefs)(d,j,i.onViewportChange);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:g}),(0,b.jsx)(s.Primitive.div,{"data-radix-scroll-area-viewport":"",...h,ref:k,style:{overflowX:i.scrollbarXEnabled?"scroll":"hidden",overflowY:i.scrollbarYEnabled?"scroll":"hidden",...a.style},children:(0,b.jsx)("div",{ref:i.onContentChange,style:{minWidth:"100%",display:"table"},children:f})})]})});U.displayName=T;var V="ScrollAreaScrollbar",W=c.forwardRef((a,d)=>{let{forceMount:e,...f}=a,g=R(V,a.__scopeScrollArea),{onScrollbarXEnabledChange:h,onScrollbarYEnabledChange:i}=g,j="horizontal"===a.orientation;return c.useEffect(()=>(j?h(!0):i(!0),()=>{j?h(!1):i(!1)}),[j,h,i]),"hover"===g.type?(0,b.jsx)(X,{...f,ref:d,forceMount:e}):"scroll"===g.type?(0,b.jsx)(Y,{...f,ref:d,forceMount:e}):"auto"===g.type?(0,b.jsx)(Z,{...f,ref:d,forceMount:e}):"always"===g.type?(0,b.jsx)($,{...f,ref:d}):null});W.displayName=V;var X=c.forwardRef((a,d)=>{let{forceMount:e,...f}=a,g=R(V,a.__scopeScrollArea),[h,i]=c.useState(!1);return c.useEffect(()=>{let a=g.scrollArea,b=0;if(a){let c=()=>{window.clearTimeout(b),i(!0)},d=()=>{b=window.setTimeout(()=>i(!1),g.scrollHideDelay)};return a.addEventListener("pointerenter",c),a.addEventListener("pointerleave",d),()=>{window.clearTimeout(b),a.removeEventListener("pointerenter",c),a.removeEventListener("pointerleave",d)}}},[g.scrollArea,g.scrollHideDelay]),(0,b.jsx)(H.Presence,{present:e||h,children:(0,b.jsx)(Z,{"data-state":h?"visible":"hidden",...f,ref:d})})}),Y=c.forwardRef((a,d)=>{var e;let{forceMount:f,...g}=a,h=R(V,a.__scopeScrollArea),i="horizontal"===a.orientation,j=aq(()=>l("SCROLL_END"),100),[k,l]=(e={hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}},c.useReducer((a,b)=>e[a][b]??a,"hidden"));return c.useEffect(()=>{if("idle"===k){let a=window.setTimeout(()=>l("HIDE"),h.scrollHideDelay);return()=>window.clearTimeout(a)}},[k,h.scrollHideDelay,l]),c.useEffect(()=>{let a=h.viewport,b=i?"scrollLeft":"scrollTop";if(a){let c=a[b],d=()=>{let d=a[b];c!==d&&(l("SCROLL"),j()),c=d};return a.addEventListener("scroll",d),()=>a.removeEventListener("scroll",d)}},[h.viewport,i,l,j]),(0,b.jsx)(H.Presence,{present:f||"hidden"!==k,children:(0,b.jsx)($,{"data-state":"hidden"===k?"hidden":"visible",...g,ref:d,onPointerEnter:(0,M.composeEventHandlers)(a.onPointerEnter,()=>l("POINTER_ENTER")),onPointerLeave:(0,M.composeEventHandlers)(a.onPointerLeave,()=>l("POINTER_LEAVE"))})})}),Z=c.forwardRef((a,d)=>{let e=R(V,a.__scopeScrollArea),{forceMount:f,...g}=a,[h,i]=c.useState(!1),j="horizontal"===a.orientation,k=aq(()=>{if(e.viewport){let a=e.viewport.offsetWidth<e.viewport.scrollWidth,b=e.viewport.offsetHeight<e.viewport.scrollHeight;i(j?a:b)}},10);return ar(e.viewport,k),ar(e.content,k),(0,b.jsx)(H.Presence,{present:f||h,children:(0,b.jsx)($,{"data-state":h?"visible":"hidden",...g,ref:d})})}),$=c.forwardRef((a,d)=>{let{orientation:e="vertical",...f}=a,g=R(V,a.__scopeScrollArea),h=c.useRef(null),i=c.useRef(0),[j,k]=c.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),l=al(j.viewport,j.content),m={...f,sizes:j,onSizesChange:k,hasThumb:!!(l>0&&l<1),onThumbChange:a=>h.current=a,onThumbPointerUp:()=>i.current=0,onThumbPointerDown:a=>i.current=a};function n(a,b){return function(a,b,c,d="ltr"){let e=am(c),f=b||e/2,g=c.scrollbar.paddingStart+f,h=c.scrollbar.size-c.scrollbar.paddingEnd-(e-f),i=c.content-c.viewport;return ao([g,h],"ltr"===d?[0,i]:[-1*i,0])(a)}(a,i.current,j,b)}return"horizontal"===e?(0,b.jsx)(_,{...m,ref:d,onThumbPositionChange:()=>{if(g.viewport&&h.current){let a=an(g.viewport.scrollLeft,j,g.dir);h.current.style.transform=`translate3d(${a}px, 0, 0)`}},onWheelScroll:a=>{g.viewport&&(g.viewport.scrollLeft=a)},onDragScroll:a=>{g.viewport&&(g.viewport.scrollLeft=n(a,g.dir))}}):"vertical"===e?(0,b.jsx)(aa,{...m,ref:d,onThumbPositionChange:()=>{if(g.viewport&&h.current){let a=an(g.viewport.scrollTop,j);h.current.style.transform=`translate3d(0, ${a}px, 0)`}},onWheelScroll:a=>{g.viewport&&(g.viewport.scrollTop=a)},onDragScroll:a=>{g.viewport&&(g.viewport.scrollTop=n(a))}}):null}),_=c.forwardRef((a,d)=>{let{sizes:e,onSizesChange:f,...g}=a,h=R(V,a.__scopeScrollArea),[i,j]=c.useState(),k=c.useRef(null),l=(0,I.useComposedRefs)(d,k,h.onScrollbarXChange);return c.useEffect(()=>{k.current&&j(getComputedStyle(k.current))},[k]),(0,b.jsx)(ad,{"data-orientation":"horizontal",...g,ref:l,sizes:e,style:{bottom:0,left:"rtl"===h.dir?"var(--radix-scroll-area-corner-width)":0,right:"ltr"===h.dir?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":am(e)+"px",...a.style},onThumbPointerDown:b=>a.onThumbPointerDown(b.x),onDragScroll:b=>a.onDragScroll(b.x),onWheelScroll:(b,c)=>{if(h.viewport){let d=h.viewport.scrollLeft+b.deltaX;a.onWheelScroll(d),function(a,b){return a>0&&a<b}(d,c)&&b.preventDefault()}},onResize:()=>{k.current&&h.viewport&&i&&f({content:h.viewport.scrollWidth,viewport:h.viewport.offsetWidth,scrollbar:{size:k.current.clientWidth,paddingStart:ak(i.paddingLeft),paddingEnd:ak(i.paddingRight)}})}})}),aa=c.forwardRef((a,d)=>{let{sizes:e,onSizesChange:f,...g}=a,h=R(V,a.__scopeScrollArea),[i,j]=c.useState(),k=c.useRef(null),l=(0,I.useComposedRefs)(d,k,h.onScrollbarYChange);return c.useEffect(()=>{k.current&&j(getComputedStyle(k.current))},[k]),(0,b.jsx)(ad,{"data-orientation":"vertical",...g,ref:l,sizes:e,style:{top:0,right:"ltr"===h.dir?0:void 0,left:"rtl"===h.dir?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":am(e)+"px",...a.style},onThumbPointerDown:b=>a.onThumbPointerDown(b.y),onDragScroll:b=>a.onDragScroll(b.y),onWheelScroll:(b,c)=>{if(h.viewport){let d=h.viewport.scrollTop+b.deltaY;a.onWheelScroll(d),function(a,b){return a>0&&a<b}(d,c)&&b.preventDefault()}},onResize:()=>{k.current&&h.viewport&&i&&f({content:h.viewport.scrollHeight,viewport:h.viewport.offsetHeight,scrollbar:{size:k.current.clientHeight,paddingStart:ak(i.paddingTop),paddingEnd:ak(i.paddingBottom)}})}})}),[ab,ac]=O(V),ad=c.forwardRef((a,d)=>{let{__scopeScrollArea:e,sizes:f,hasThumb:g,onThumbChange:h,onThumbPointerUp:i,onThumbPointerDown:j,onThumbPositionChange:k,onDragScroll:l,onWheelScroll:m,onResize:n,...o}=a,p=R(V,e),[q,r]=c.useState(null),t=(0,I.useComposedRefs)(d,a=>r(a)),u=c.useRef(null),v=c.useRef(""),w=p.viewport,x=f.content-f.viewport,y=(0,J.useCallbackRef)(m),z=(0,J.useCallbackRef)(k),A=aq(n,10);function B(a){u.current&&l({x:a.clientX-u.current.left,y:a.clientY-u.current.top})}return c.useEffect(()=>{let a=a=>{let b=a.target;q?.contains(b)&&y(a,x)};return document.addEventListener("wheel",a,{passive:!1}),()=>document.removeEventListener("wheel",a,{passive:!1})},[w,q,x,y]),c.useEffect(z,[f,z]),ar(q,A),ar(p.content,A),(0,b.jsx)(ab,{scope:e,scrollbar:q,hasThumb:g,onThumbChange:(0,J.useCallbackRef)(h),onThumbPointerUp:(0,J.useCallbackRef)(i),onThumbPositionChange:z,onThumbPointerDown:(0,J.useCallbackRef)(j),children:(0,b.jsx)(s.Primitive.div,{...o,ref:t,style:{position:"absolute",...o.style},onPointerDown:(0,M.composeEventHandlers)(a.onPointerDown,a=>{0===a.button&&(a.target.setPointerCapture(a.pointerId),u.current=q.getBoundingClientRect(),v.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",p.viewport&&(p.viewport.style.scrollBehavior="auto"),B(a))}),onPointerMove:(0,M.composeEventHandlers)(a.onPointerMove,B),onPointerUp:(0,M.composeEventHandlers)(a.onPointerUp,a=>{let b=a.target;b.hasPointerCapture(a.pointerId)&&b.releasePointerCapture(a.pointerId),document.body.style.webkitUserSelect=v.current,p.viewport&&(p.viewport.style.scrollBehavior=""),u.current=null})})})}),ae="ScrollAreaThumb",af=c.forwardRef((a,c)=>{let{forceMount:d,...e}=a,f=ac(ae,a.__scopeScrollArea);return(0,b.jsx)(H.Presence,{present:d||f.hasThumb,children:(0,b.jsx)(ag,{ref:c,...e})})}),ag=c.forwardRef((a,d)=>{let{__scopeScrollArea:e,style:f,...g}=a,h=R(ae,e),i=ac(ae,e),{onThumbPositionChange:j}=i,k=(0,I.useComposedRefs)(d,a=>i.onThumbChange(a)),l=c.useRef(void 0),m=aq(()=>{l.current&&(l.current(),l.current=void 0)},100);return c.useEffect(()=>{let a=h.viewport;if(a){let b=()=>{m(),l.current||(l.current=ap(a,j),j())};return j(),a.addEventListener("scroll",b),()=>a.removeEventListener("scroll",b)}},[h.viewport,m,j]),(0,b.jsx)(s.Primitive.div,{"data-state":i.hasThumb?"visible":"hidden",...g,ref:k,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...f},onPointerDownCapture:(0,M.composeEventHandlers)(a.onPointerDownCapture,a=>{let b=a.target.getBoundingClientRect(),c=a.clientX-b.left,d=a.clientY-b.top;i.onThumbPointerDown({x:c,y:d})}),onPointerUp:(0,M.composeEventHandlers)(a.onPointerUp,i.onThumbPointerUp)})});af.displayName=ae;var ah="ScrollAreaCorner",ai=c.forwardRef((a,c)=>{let d=R(ah,a.__scopeScrollArea),e=!!(d.scrollbarX&&d.scrollbarY);return"scroll"!==d.type&&e?(0,b.jsx)(aj,{...a,ref:c}):null});ai.displayName=ah;var aj=c.forwardRef((a,d)=>{let{__scopeScrollArea:e,...f}=a,g=R(ah,e),[h,i]=c.useState(0),[j,k]=c.useState(0),l=!!(h&&j);return ar(g.scrollbarX,()=>{let a=g.scrollbarX?.offsetHeight||0;g.onCornerHeightChange(a),k(a)}),ar(g.scrollbarY,()=>{let a=g.scrollbarY?.offsetWidth||0;g.onCornerWidthChange(a),i(a)}),l?(0,b.jsx)(s.Primitive.div,{...f,ref:d,style:{width:h,height:j,position:"absolute",right:"ltr"===g.dir?0:void 0,left:"rtl"===g.dir?0:void 0,bottom:0,...a.style}}):null});function ak(a){return a?parseInt(a,10):0}function al(a,b){let c=a/b;return isNaN(c)?0:c}function am(a){let b=al(a.viewport,a.content),c=a.scrollbar.paddingStart+a.scrollbar.paddingEnd;return Math.max((a.scrollbar.size-c)*b,18)}function an(a,b,c="ltr"){let d=am(b),e=b.scrollbar.paddingStart+b.scrollbar.paddingEnd,f=b.scrollbar.size-e,g=b.content-b.viewport,h=function(a,[b,c]){return Math.min(c,Math.max(b,a))}(a,"ltr"===c?[0,g]:[-1*g,0]);return ao([0,g],[0,f-d])(h)}function ao(a,b){return c=>{if(a[0]===a[1]||b[0]===b[1])return b[0];let d=(b[1]-b[0])/(a[1]-a[0]);return b[0]+d*(c-a[0])}}var ap=(a,b=()=>{})=>{let c={left:a.scrollLeft,top:a.scrollTop},d=0;return!function e(){let f={left:a.scrollLeft,top:a.scrollTop},g=c.left!==f.left,h=c.top!==f.top;(g||h)&&b(),c=f,d=window.requestAnimationFrame(e)}(),()=>window.cancelAnimationFrame(d)};function aq(a,b){let d=(0,J.useCallbackRef)(a),e=c.useRef(0);return c.useEffect(()=>()=>window.clearTimeout(e.current),[]),c.useCallback(()=>{window.clearTimeout(e.current),e.current=window.setTimeout(d,b)},[d,b])}function ar(a,b){let c=(0,J.useCallbackRef)(b);(0,L.useLayoutEffect)(()=>{let b=0;if(a){let d=new ResizeObserver(()=>{cancelAnimationFrame(b),b=window.requestAnimationFrame(c)});return d.observe(a),()=>{window.cancelAnimationFrame(b),d.unobserve(a)}}},[a,c])}function as({className:a,children:c,...d}){return(0,b.jsxs)(S,{"data-slot":"scroll-area",className:(0,i.cn)("relative",a),...d,children:[(0,b.jsx)(U,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:c}),(0,b.jsx)(at,{}),(0,b.jsx)(ai,{})]})}function at({className:a,orientation:c="vertical",...d}){return(0,b.jsx)(W,{"data-slot":"scroll-area-scrollbar",orientation:c,className:(0,i.cn)("flex touch-none p-px transition-colors select-none","vertical"===c&&"h-full w-2.5 border-l border-l-transparent","horizontal"===c&&"h-2.5 flex-col border-t border-t-transparent",a),...d,children:(0,b.jsx)(af,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}var au=a.i(46147);function av({status:a}){return(0,b.jsx)(au.Badge,{variant:"outline",className:"connected"===a?"border-slate-400 text-muted-foreground":"connecting"===a?"border-dashed border-slate-400 text-muted-foreground":"error"===a?"border-slate-700 text-slate-700":"border-slate-300 text-muted-foreground",children:a})}function aw({status:a}){let c="Тревога"===a?"bg-slate-700":"Подозрение"===a?"bg-slate-500":"bg-slate-300";return(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:`inline-block h-2.5 w-2.5 rounded-full ${c}`}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Краткосрочный статус:"}),(0,b.jsx)("span",{className:"font-medium text-sm",children:a})]})}var ax=a.i(46373);function ay({events:a}){if(!a||0===a.length)return(0,b.jsx)("div",{className:"h-32 rounded border flex items-center justify-center",children:(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Нет событий"})});let c=[...a].sort((a,b)=>b.severity-a.severity);return(0,b.jsx)(as,{className:"h-32 rounded border",children:(0,b.jsx)("div",{className:"p-3 space-y-3",children:c.map((a,d)=>(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(au.Badge,{variant:"outline",className:"text-xs uppercase tracking-wide text-muted-foreground",children:a.type}),(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:["severity: ",a.severity.toFixed(2)]})]})}),(0,b.jsx)(G,{className:"bg-muted/40",indicatorClassName:"bg-slate-500",value:Math.max(0,Math.min(100,100*a.severity))}),d<c.length-1&&(0,b.jsx)(ax.Separator,{})]},`${a.type}-${d}`))})})}function az(){(0,j.useAIWebSocket)();let a=g(),c=h();return(0,b.jsxs)(q.Card,{className:"w-full h-full flex flex-col",children:[(0,b.jsx)(q.CardHeader,{className:"flex-shrink-0",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(q.CardTitle,{children:"AI Analysis"}),(0,b.jsx)(q.CardDescription,{children:"Статус и вероятности"})]}),(0,b.jsx)(av,{status:c})]})}),(0,b.jsx)(q.CardContent,{className:"flex-1 overflow-hidden p-6 pt-0",children:(0,b.jsx)(as,{className:"h-full",children:(0,b.jsxs)("div",{className:"space-y-4",children:[a?.short_term.status&&(0,b.jsx)(aw,{status:a.short_term.status}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm text-muted-foreground mb-2",children:"События"}),(0,b.jsx)(ay,{events:a?.short_term.events??[]})]}),(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Hypoxia 60"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:a?`${(100*a.long_term.hypoxia_60).toFixed(1)}%`:"—"})]}),(0,b.jsx)(G,{className:"bg-muted/40",indicatorClassName:"bg-slate-500",value:a?Math.max(0,Math.min(100,100*a.long_term.hypoxia_60)):0})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Emergency 30"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:a?`${(100*a.long_term.emergency_30).toFixed(1)}%`:"—"})]}),(0,b.jsx)(G,{className:"bg-muted/40",indicatorClassName:"bg-slate-500",value:a?Math.max(0,Math.min(100,100*a.long_term.emergency_30)):0})]})]})]})})})]})}var aA=a.i(20150);let aB=(0,aA.default)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),aC=(0,aA.default)("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),aD=(0,aA.default)("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),aE=(0,aA.default)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var aF=a.i(45123),aF=aF;let aG={error:{icon:aB,label:"Критично",accent:"border-l-slate-500"},warning:{icon:aB,label:"Важно",accent:"border-l-slate-400"},info:{icon:aE,label:"Информация",accent:"border-l-slate-300"},success:{icon:aD,label:"Событие",accent:"border-l-slate-300"}};function aH(){let a=function(){let a=g(),b=h(),[d,e]=(0,c.useState)([]),f=(0,c.useRef)(new Map),i=(0,c.useRef)(null),j=(0,c.useRef)(null),k=(0,c.useCallback)(a=>{if(!a.length)return;let b=new Map(f.current),c=!1;if(a.forEach(a=>{let d=b.get(a.id);d&&d.timestamp.getTime()===a.timestamp.getTime()||(b.set(a.id,a),c=!0)}),!c)return;let d=Array.from(b.values()).sort((a,b)=>b.timestamp.getTime()-a.timestamp.getTime()).slice(0,100);f.current=new Map(d.map(a=>[a.id,a])),e(d)},[]);return(0,c.useEffect)(()=>{if(!b||i.current===b)return;let a=function(a){let b={timestamp:new Date,acknowledged:"error"!==a};switch(a){case"connected":return{id:`connection-${a}-${b.timestamp.getTime()}`,type:"info",title:"AI подключен",message:"Система анализа данных активна",...b};case"connecting":return{id:`connection-${a}-${b.timestamp.getTime()}`,type:"info",title:"Подключение к AI",message:"Устанавливаем соединение с системой анализа",...b};case"error":return{id:`connection-${a}-${b.timestamp.getTime()}`,type:"error",title:"Ошибка подключения AI",message:"Не удается подключиться к системе анализа",...b,acknowledged:!1};default:return{id:`connection-${a}-${b.timestamp.getTime()}`,type:"info",title:"Соединение разорвано",message:"Ожидаем новое подключение к системе анализа",...b}}}(b);i.current=b,a&&k([a])},[b,k]),(0,c.useEffect)(()=>{if(!a)return;let b=[a.time,a.short_term.status,a.short_term.events.map(a=>`${a.type}:${a.severity.toFixed(2)}`).join("|"),a.long_term.hypoxia_60.toFixed(2),a.long_term.emergency_30.toFixed(2)].join("-");j.current!==b&&(j.current=b,k(function(a){let b=[],c=new Date(1e3*a.time),d=a.short_term.status;return"Тревога"===d?b.push({id:`status-alert-${a.time}`,type:"error",title:"Критический статус",message:"Обнаружена тревога в анализе данных",timestamp:c,acknowledged:!1}):"Подозрение"===d&&b.push({id:`status-warning-${a.time}`,type:"warning",title:"Подозрительная активность",message:`Требуется внимание: ${d}`,timestamp:c,acknowledged:!1}),a.short_term.events.forEach((d,e)=>{d.severity>.7?b.push({id:`event-high-${a.time}-${e}`,type:"error",title:"Высокий риск события",message:`${d.type}: уровень ${d.severity.toFixed(2)}`,timestamp:c,acknowledged:!1,severity:d.severity}):d.severity>.4&&b.push({id:`event-medium-${a.time}-${e}`,type:"warning",title:"Повышенное внимание к событию",message:`${d.type}: уровень ${d.severity.toFixed(2)}`,timestamp:c,acknowledged:!1,severity:d.severity})}),a.long_term.hypoxia_60>.8?b.push({id:`hypoxia-high-${a.time}`,type:"error",title:"Высокий риск гипоксии",message:`Вероятность гипоксии 60 мин: ${(100*a.long_term.hypoxia_60).toFixed(1)}%`,timestamp:c,acknowledged:!1}):a.long_term.hypoxia_60>.6&&b.push({id:`hypoxia-medium-${a.time}`,type:"warning",title:"Повышенный риск гипоксии",message:`Вероятность гипоксии 60 мин: ${(100*a.long_term.hypoxia_60).toFixed(1)}%`,timestamp:c,acknowledged:!1}),a.long_term.emergency_30>.7?b.push({id:`emergency-high-${a.time}`,type:"error",title:"Высокий риск экстренной ситуации",message:`Вероятность экстренной ситуации 30 мин: ${(100*a.long_term.emergency_30).toFixed(1)}%`,timestamp:c,acknowledged:!1}):a.long_term.emergency_30>.5&&b.push({id:`emergency-medium-${a.time}`,type:"warning",title:"Повышенный риск экстренной ситуации",message:`Вероятность экстренной ситуации 30 мин: ${(100*a.long_term.emergency_30).toFixed(1)}%`,timestamp:c,acknowledged:!1}),b}(a)))},[a,k]),d}(),[d,e]=(0,c.useState)(new Set),f=a.filter(a=>!d.has(a.id));return(0,b.jsxs)(q.Card,{className:"w-full h-full flex flex-col",children:[(0,b.jsx)(q.CardHeader,{className:"flex-shrink-0",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(q.CardTitle,{children:"Предупреждения"}),(0,b.jsx)(q.CardDescription,{children:"Системные уведомления и события"})]}),(0,b.jsxs)(au.Badge,{variant:"outline",className:"border-muted-foreground/30 text-muted-foreground",children:[f.length," активных"]})]})}),(0,b.jsx)(q.CardContent,{className:"flex-1 overflow-hidden p-6 pt-0",children:(0,b.jsx)(as,{className:"h-full",children:(0,b.jsxs)("div",{className:"space-y-4",children:[f.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("h4",{className:"text-sm font-medium text-muted-foreground mb-3",children:["Требуют внимания (",f.length,")"]}),(0,b.jsx)(as,{className:"h-48",children:(0,b.jsx)("div",{className:"space-y-3 pr-4",children:f.map(a=>{let c=aG[a.type]??aG.info;return(0,b.jsxs)("div",{className:`flex items-start gap-3 rounded-lg border border-slate-200 bg-muted/40 p-3 shadow-sm border-l-4 ${c.accent}`,children:[function(a){let c=aG[a]?.icon??aC;return(0,b.jsx)(c,{className:"h-4 w-4 text-muted-foreground",strokeWidth:1.5})}(a.type),(0,b.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsx)("h5",{className:"text-sm font-medium leading-tight",children:a.title}),(0,b.jsx)(au.Badge,{variant:"outline",className:"text-[10px] uppercase tracking-wide text-muted-foreground",children:c.label})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground leading-snug",children:a.message}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:function(a){let b=Math.floor((new Date().getTime()-a.getTime())/1e3),c=Math.floor(b/60),d=Math.floor(c/60);return b<60?`${b}с назад`:c<60?`${c}м назад`:d<24?`${d}ч назад`:a.toLocaleDateString()}(a.timestamp)})]}),(0,b.jsx)(n.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-muted-foreground",onClick:()=>{var b;return b=a.id,void e(a=>new Set([...a,b]))},children:(0,b.jsx)(aF.default,{className:"h-3 w-3"})})]},a.id)})})})]}),0===f.length&&(0,b.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,b.jsx)(aC,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),(0,b.jsx)("p",{className:"text-sm",children:"Нет активных предупреждений"})]})]})})})]})}var aI=a.i(52011);function aJ(){return(0,b.jsxs)(aI.AppSidebarLayout,{title:"Мониторинг",contentClassName:"gap-6 overflow-hidden",children:[(0,b.jsx)("div",{className:"flex-shrink-0",children:(0,b.jsx)(p,{})}),(0,b.jsxs)("div",{className:"grid flex-1 min-h-0 gap-6 lg:grid-cols-2",children:[(0,b.jsx)(az,{}),(0,b.jsx)(aH,{})]})]})}}];

//# sourceMappingURL=kosty_lct_frontend_src_app_monitoring_page_tsx_bcc20446._.js.map